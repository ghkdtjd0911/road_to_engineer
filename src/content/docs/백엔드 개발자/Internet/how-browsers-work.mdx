---
title: 브라우저
---

### 브라우저란?

웹 브라우저는 사용자가 GUI를 통해 웹 페이지나 기타 온라인 콘텐츠에 액세스하고 표시할 수 있게 해주는 소프트웨어 애플리케이션입니다.

사용자에게 빠르고 부드러운 웹 경험을 제공하기 위해 개발자는 페이지 로딩 속도와 상호 작용의 부드러움을 개선해야 합니다. 

이를 위해서는 브라우저의 작동 방식, 특히 지연 시간 문제와 브라우저의 단일 스레드 특성을 이해하는 것이 중요합니다.

#### 탐색 (Navigation)

웹 페이지 로딩의 첫 번째 단계인 탐색은 사용자가 URL 입력, 링크 클릭, 양식 제출 등의 동작을 통해 페이지를 요청할 때 발생합니다.

탐색 시간을 최소화하기 위해 DNS 조회, TCP 핸드셰이크, TLS 협상 과정을 거치게 됩니다.

##### DNS 조회 (DNS Lookup)

웹 페이지의 애셋 위치를 찾는 과정입니다. 

브라우저는 DNS 서버에 요청을 보내 호스트 이름에 해당하는 IP 주소를 얻습니다. 

DNS 조회 결과는 캐싱되어 이후 요청 속도를 향상시킵니다.

##### TCP 핸드쉐이크 (TCP handshake)

브라우저는 IP 주소를 알게 되면 TCP 3-way 핸드셰이크를 통해 서버와 연결을 설정합니다.

이를 통해 브라우저와 웹 서버는 데이터 전송 전에 네트워크 TCP 소켓 연결 매개변수를 협상합니다.

##### TLS 협상 (TLS negotiation)

HTTPS를 통해 설정된 보안 연결의 경우 TLS 협상이 필요합니다. 

이 협상을 통해 통신 암호화에 사용할 암호를 결정하고, 서버를 확인하고, 실제 데이터 전송 전에 보안 연결이 설정되었는지 확인합니다.

#### 응답 (Response)

연결 설정 후 브라우저는 서버에 HTTP GET 요청을 보냅니다. 

서버는 관련 응답 헤더와 HTML 콘텐츠를 회신합니다. 

첫 번째 데이터 청크 수신 시간을 나타내는 TTFB(Time to First Byte)는 웹 성능 최적화의 중요한 지표입니다.

###### 정체 제어 / TCP 슬로우 스타트 (Congestion control / TCP slow start)

TCP 패킷은 전송 중에 세그먼트로 분할됩니다. 

TCP 슬로우 스타트 알고리즘은 네트워크 정체를 방지하기 위해 전송되는 데이터 양을 점진적으로 늘리거나 줄여 전송 속도를 조절합니다.

#### 파싱 (Parsing)

브라우저가 첫 번째 데이터 청크를 수신하면 파싱을 시작합니다.

파싱은 네트워크를 통해 수신한 데이터를 DOM 및 CSSOM으로 변환하는 과정입니다.

##### DOM 트리 구축

HTML 마크업을 처리하여 DOM 트리를 구축하는 과정입니다. 

DOM 트리는 문서의 콘텐츠를 나타내며, 각 요소 간의 관계와 계층 구조를 반영합니다.

##### 프리로드 스캐너

브라우저가 DOM 트리를 구축하는 동안 프리로드 스캐너는 CSS, JavaScript, 웹 글꼴과 같은 높은 우선 순위의 리소스를 파싱하고 요청합니다. 

이를 통해 리소스를 백그라운드에서 가져와서 HTML 파서가 요청된 애셋에 도달할 때까지 기다리는 시간을 줄일 수 있습니다.

##### CSSOM 트리 구축

CSS를 처리하고 CSSOM 트리를 구축하는 과정입니다.

CSSOM 트리는 브라우저가 이해하고 작동할 수 있는 스타일 맵으로 CSS 규칙을 변환하여 생성됩니다.

##### 기타 프로세스

JavaScript 컴파일, 접근성 트리 구축과 같은 다른 프로세스도 동시에 진행됩니다.

#### 렌더링

파싱 단계에서 생성된 CSSOM 및 DOM 트리는 렌더 트리로 결합됩니다.

렌더링 단계에는 스타일, 레이아웃, 페인트, 합성 과정이 포함됩니다.

##### 스타일

DOM 및 CSSOM을 결합하여 렌더 트리를 생성하는 단계입니다. 

렌더 트리는 표시되는 모든 노드와 계산된 스타일을 포함합니다.

##### 레이아웃

렌더 트리의 각 노드의 크기와 위치를 계산하는 과정입니다. 

이 과정에서 브라우저는 뷰포트 크기를 고려하여 각 요소의 크기와 위치를 결정합니다.

##### 페인트

레이아웃 단계에서 계산된 각 상자를 화면의 실제 픽셀로 변환하는 과정입니다. 

브라우저는 텍스트, 색상, 테두리, 그림자 등 요소의 모든 시각적 부분을 화면에 그립니다.

##### 합성

문서의 여러 섹션이 서로 다른 레이어에 그려질 때 합성 과정을 통해 올바른 순서로 화면에 그려지도록 합니다.

#### 상호작용

메인 스레드가 페이지 페인팅을 완료한 후 JavaScript 로드, 지연 로드, onload 이벤트 발생 후 실행 등의 작업이 수행될 수 있습니다.

이러한 작업으로 인해 메인 스레드가 바빠서 스크롤, 터치 등의 상호 작용에 사용하지 못할 수 있습니다.

TTI(Time to Interactive)는 첫 번째 요청부터 페이지가 상호 작용할 수 있을 때까지 걸리는 시간을 측정한 것입니다.

이러한 정보를 통해 웹 페이지 로딩 과정과 각 단계의 중요성을 이해하고 웹 성능 최적화 전략을 수립하는 데 도움이 될 수 있습니다.

#### References

[how browsers work](https://developer.mozilla.org/en-US/docs/Web/Performance/How_browsers_work)
